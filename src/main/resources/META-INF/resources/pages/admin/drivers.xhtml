<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<title>
    Drivers
</title>
<h:head>
    <h:outputStylesheet name="primefaces/components.css"/>
    <h:outputStylesheet name="style/style.css"/>
</h:head>
<h:body>
    <p:fieldset id="drivers" legend="Drivers">
        <h:form id="driverForm">
            <p:growl id="msgs" showDetail="true"/>

            <p:dataTable id="driver" var="driver" value="#{dtDriver.drivers}" editable="true" style="margin-bottom:20px"
            paginator="true" paginatorPosition="bottom" rows="8">

                <p:ajax event="rowEdit" listener="#{dtDriver.onRowEdit}"
                        update="driverForm:msgs,driverForm:driver,carsForm:car"/>
                <p:ajax event="rowEditCancel" listener="#{dtDriver.onRowCancel}" update="driverForm:msgs"/>

                <p:column headerText="ID" style="width: 35px">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{driver.id}"/></f:facet>
                        <f:facet name="input"><p:inputText id="modelInput" value="#{driver.id}" style="width:100%"
                                                           disabled="true"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Имя">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{driver.firstName}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{driver.firstName}" style="width:100%"
                                                           label="firstname"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Фамилия">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{driver.lastName}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{driver.lastName}" style="width:100%" label="lastname"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Номер телефона">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{driver.phoneNumber}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{driver.phoneNumber}" style="width:100%" label="phone"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Курит?" style="width: 50px">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText
                                value="#{driver.smoking == false ? 'нет' : 'да'}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{driver.smoking}" style="width:100%"
                                                           label="smoking"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="ID автомобиля" style="width: 75px">
                    <p:cellEditor>

                        <f:facet name="output"><h:outputText value="#{driver.car.id}"/></f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{dtDriver.carId}"
                                         style="width:100%" label="carId">
                                <p:ajax />
                            </p:inputText>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column style="width:32px">
                    <p:rowEditor/>
                </p:column>

                <p:column style="width:90px">
                    <p:commandButton value="Удалить" action="#{dtDriver.deleteRow}"
                                     update="driverForm:msgs,driverForm:driver">
                        <f:setPropertyActionListener value="#{driver}" target="#{dtDriver.selectedDriver}"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>

            <div class="ui-g">
                <div class="ui-g-12">
                    <p:commandButton value="Добавить водителя" styleClass="ui-priority-primary"
                                     update="driverForm:msgs,driverForm:driver"
                                     actionListener="#{dtDriver.onAddNew()}"/>
                </div>
            </div>
        </h:form>
    </p:fieldset>
    <p:spacer/>
    <p:fieldset id="cars" legend="Cars">
        <h:form id="carsForm">

            <p:growl id="carMsgs" showDetail="true"/>
            <p:dataTable id="car" var="car" value="#{dtCar.cars}" editable="true" style="margin-bottom:20px"
                         paginator="true" paginatorPosition="bottom" rows="8">
                <f:facet name="header">
                    Row Editing
                </f:facet>

                <p:ajax event="rowEdit" listener="#{dtCar.onRowEdit}"
                        update="carsForm:carMsgs,carsForm:car,driverForm:driver"/>
                <p:ajax event="rowEditCancel" listener="#{dtCar.onRowCancel}" update="carsForm:carMsgs"/>

                <p:column headerText="ID" style="width: 32px">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.id}"/></f:facet>
                        <f:facet name="input"><p:inputText id="modelCarInput" value="#{car.id}" style="width:100%"
                                                           disabled="true"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Марка авто">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.carBrand}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{car.carBrand}" style="width:100%"
                                                           label="firstname"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Модель авто">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.carModel}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{car.carModel}" style="width:100%"
                                                           label="carmodel"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Номер авто">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.carNumber}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{car.carNumber}" style="width:100%"
                                                           label="carbrand"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Номер талона техобслуживания">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.technicalCoupon}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{car.technicalCoupon}" style="width:100%"
                                                           label="technicalCoupon"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Номер страховки">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.numberOfCoverage}"/></f:facet>
                        <f:facet name="input"><p:inputText value="#{car.numberOfCoverage}" style="width:100%"
                                                           label="numberOfCoverage"/></f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="Сервис">
                    <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{car.carType}"/></f:facet>
                        <p:importEnum type="com.vozup.givemetaxi.enums.CarType" var="CarType"
                                      allSuffix="ALL_ENUM_VALUES"/>
                        <f:facet name="input">
                            <h:selectOneMenu value="#{car.carType}" style="width:100%">
                                <f:selectItems value="#{CarType.ALL_ENUM_VALUES}" var="type" itemLabel="#{type}"
                                               itemValue="#{type}"/>
                            </h:selectOneMenu>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column style="width:32px">
                    <p:rowEditor/>
                </p:column>

                <p:column style="width:90px">
                    <p:commandButton value="Удалить" action="#{dtCar.deleteRow}"
                                     update="carsForm:car,carsForm:carMsgs">
                        <f:setPropertyActionListener value="#{car}" target="#{dtCar.selectedCar}"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>

            <div class="ui-g">
                <div class="ui-g-12">
                    <p:commandButton value="Добавить авто" styleClass="ui-priority-primary"
                                     update="carsForm:car,carsForm:carMsgs"
                                     actionListener="#{dtCar.onAddNew()}"/>
                </div>
            </div>
        </h:form>
    </p:fieldset>

</h:body>
</html>